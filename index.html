<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>18 個數字隨機平均分組</title>
<style>
  body {font-family:Arial,Helvetica,sans-serif; margin:20px; background:#f9f9f9;}
  h1 {text-align:center;}
  .container {max-width:800px;margin:auto;}
  .checklist {display:grid;grid-template-columns:repeat(6,1fr);gap:8px; margin-bottom:15px;}
  .checklist label {display:flex;align-items:center;cursor:pointer;}
  .checklist input {margin-right:4px;}
  .btn {padding:10px 20px;font-size:16px;background:#0066cc;color:#fff;border:none;border-radius:4px;cursor:pointer;}
  .btn:hover {background:#004999;}
  .result {display:flex;justify-content:space-around;margin-top:25px;}
  .group {background:#fff;padding:15px;border-radius:6px;box-shadow:0 2px 5px rgba(0,0,0,0.1);width:30%;}
  .group h2 {font-size:18px;margin-top:0;text-align:center;}
  .group ul {list-style:none;padding:0;margin:0;}
  .group li {padding:4px 0;border-bottom:1px solid #eee;}
</style>
</head>
<body>
<div class="container">
  <h1>18 個數字隨機平均分組</h1>

  <!-- 1. 勾選哪些位置是「標記」 -->
  <p>請勾選要「標記」的數字位置（提供設定位置）：</p>
  <div class="checklist" id="checklist"></div>

  <button class="btn" onclick="distribute()">隨機分配到 3 組</button>

  <!-- 2. 顯示分組結果 -->
  <div class="result" id="result"></div>
</div>

<script>
/* ---- 變數與初始化 ---------------------------------------------------- */
const TOTAL_NUM = 18;               // 1~18
const GROUP_COUNT = 3;              // 三組
const PER_GROUP = TOTAL_NUM / GROUP_COUNT; // 每組 6 個

// 建立 1~18 的檢查清單
const checklistDiv = document.getElementById('checklist');
for (let i = 1; i <= TOTAL_NUM; i++) {
  const label = document.createElement('label');
  label.innerHTML = `<input type="checkbox" value="${i}"> ${i}`;
  checklistDiv.appendChild(label);
}
  /* ---- 輔助函式 -------------------------------------------------------- */
function shuffle(array) {
  // Fisher‑Yates shuffle
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
  return array;
}

/* ---- 主要分組函式 ---------------------------------------------------- */
function distribute() {
    const checked = [...document.querySelectorAll('#checklist input:checked')]
                  .map(cb => parseInt(cb.value,10));   // 例: [2,5,9]

  // 2️⃣ 產生完整的 1~18 數字陣列
  const allNumbers = Array.from({length: TOTAL_NUM}, (_,i) => i+1);

  // 3️⃣ 把標記與非標記分開
  const marked   = allNumbers.filter(n => checked.includes(n));
  const unmarked = allNumbers.filter(n => !checked.includes(n));

  // 4️⃣ 先把標記平均分配到三組
  const groups = Array.from({length: GROUP_COUNT}, () => []);
  const targetMarkedPerGroup = Math.floor(marked.length / GROUP_COUNT);
  const extraMarked = marked.length % GROUP_COUNT; // 會給前 extraMarked 組

  // 隨機打亂標記的順序，避免總是同樣順序
  shuffle(marked);

  // 為每組放入目標的標記個數
  let idx = 0;
  for (let g = 0; g < GROUP_COUNT; g++) {
    const need = targetMarkedPerGroup + (g < extraMarked ? 1 : 0);
    for (let i = 0; i < need; i++) {
      groups[g].push(marked[idx++]);
    }
  }

  // 5️⃣ 接著把普通數字隨機分配，填滿每組到 6 個
  shuffle(unmarked);
  let uIdx = 0;
  for (let g = 0; g < GROUP_COUNT; g++) {
    while (groups[g].length < PER_GROUP) {
      groups[g].push(unmarked[uIdx++]);
    }
  }

  // 6️⃣ 顯示結果
  const resultDiv = document.getElementById('result');
  resultDiv.innerHTML = ''; // 清空舊結果
  groups.forEach((grp, i) => {
    const box = document.createElement('div');
    box.className = 'group';
    box.innerHTML = `<h2>第 ${i+1} 組</h2><ul>` +
                    grp.map(n => `<li>${n}${checked.includes(n) ? ' <strong>(標記)</strong>' : ''}</li>`).join('') +
                    `</ul>`;
    resultDiv.appendChild(box);
  });
}
</script>
</body>
</html>
